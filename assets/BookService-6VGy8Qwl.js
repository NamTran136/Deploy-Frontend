import{c as M,r as t,a as C,A as k,B as R,j as e,x as z,y as U,z as K,L as u,J as T,w as J}from"./index-BSbp0FSU.js";import{A as G,a as X}from"./AdminSidebarMobile-4DVHEuT3.js";import{F as Y}from"./index-C9NtNJBW.js";import{P as Z}from"./Pagination-Cu-JZCf2.js";function _({sortOrder:x,columnKey:l,sortKey:c,onClick:m}){return e.jsx("button",{onClick:m,className:`${c===l&&x==="desc"?"":"rotate-180"}`,children:e.jsx(Y,{size:16})})}const Q=[{Header:"Name",value:"title"},{Header:"Author",value:"author"},{Header:"Image",value:"imageUrl"},{Header:"State",value:"isPrivate"},{Header:"Category",value:"category"}],te=()=>{const{token:x}=M(s=>s.user),[l,c]=t.useState(!1),[m,y]=t.useState(!1),[p,A]=t.useState(!1),[d,S]=t.useState([]),[P,I]=t.useState(null),[h,B]=t.useState("asc"),[j,w]=t.useState("id"),[a,i]=t.useState(1),[o]=t.useState(5),[g,F]=t.useState(0);t.useEffect(()=>{v()},[]);const v=async()=>{y(!0),await C.get(k+R).then(s=>s.data).then(s=>{S(s),F(Math.ceil(s.length/o))}).catch(s=>{I("Không có sách nào"),console.log(s)}).finally(()=>{y(!1)})};function L(s){s==="&laquo;"||s==="... "?i(1):s==="&lsaquo;"?a!==1&&i(a-1):s==="&rsaquo;"?a!==g&&i(a+1):s==="&raquo;"||s===" ..."?i(g):typeof s=="number"&&i(s)}function O({tableData:s,sortKey:n,reverse:b}){if(!n)return s;const N=s.sort((E,H)=>E[n]>H[n]?1:-1);return b?N.reverse():N}const D=t.useCallback(()=>O({tableData:d,sortKey:j,reverse:h==="desc"}),[d,j,h]);function $(s){B(h==="asc"?"desc":"asc"),w(s)}const[r,f]=t.useState({input:"",index:"1"}),q=async s=>{s.preventDefault();const{data:n,status:b}=await C.get(k+J+`/searchinput=${r.input}/${r.index}`,{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${x}`}});b===200?(S(n),f({input:"",index:"1"})):console.log("An error occurred!")};return e.jsxs("div",{className:"admin-container",style:{gridTemplateColumns:p?"1fr 15fr":"1fr 4fr",gap:p?"0.5rem":"2rem"},children:[e.jsx(G,{isFold:p,setIsFold:A}),e.jsx(X,{isOpen:l,setIsOpen:c}),e.jsx("div",{className:"open-menu-icon",children:e.jsx(z,{size:24,onClick:()=>c(!l)})}),e.jsxs("main",{className:"dashboard",children:[e.jsxs("div",{className:"bar",children:[e.jsxs("form",{onSubmit:q,children:[e.jsx("button",{type:"submit",children:e.jsx(U,{})}),e.jsx("input",{type:"text",placeholder:"Search for data, users, docs",value:r.input,onChange:s=>f({...r,input:s.target.value})}),e.jsxs("div",{className:"select-container",children:[e.jsx("label",{htmlFor:"select",children:"Search By:"}),e.jsxs("select",{value:r.index,id:"select",onChange:s=>f({...r,index:s.target.value}),children:[e.jsx("option",{value:1,children:"ID"}),e.jsx("option",{value:2,children:"Title"}),e.jsx("option",{value:3,children:"Author"}),e.jsx("option",{value:4,children:"Category"})]})]})]}),e.jsx(K,{}),e.jsx("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSXPodEp1Zyixlyx1Rrq6JJlPm0hgg1pFeLNrxgt2bkYw&s",alt:"User"})]}),e.jsx("div",{className:"table-container",children:e.jsxs("div",{className:"dashboard-category-box",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{className:"heading",children:"List of Books"}),e.jsx("button",{style:{backgroundColor:"transparent",outline:"none",border:"none",fontSize:"20px",color:"rgb(0,115,255)"},onClick:v,children:"Refresh"})]}),m&&e.jsx("span",{children:"Loading..."}),d&&e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[Q.map(s=>e.jsx("th",{children:e.jsxs("div",{className:"th-wrapper",children:[s.Header,e.jsx(_,{columnKey:s.value,onClick:()=>$(s.value),sortOrder:h,sortKey:j})]})},s.value)),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:D().slice((a-1)*o,(a-1)*o+o).map((s,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.title}),e.jsx("td",{children:s.author}),e.jsx("td",{children:e.jsx("img",{src:s.imageUrl,alt:"Image Book"})}),e.jsx("td",{children:s.isPrivate?"Private":"Public"}),e.jsx("td",{children:s.category}),e.jsxs("td",{className:"btn-wrapper",style:{display:"flex",alignItems:"center",height:"100px"},children:[e.jsx(u,{className:"bg-blue",to:`/admin/book/read/${s.id}`,children:"Read"}),e.jsx(u,{className:"bg-orange",to:`/admin/book/edit/${s.id}`,children:"Edit"}),e.jsx(u,{className:"bg-red",to:`/admin/book/delete/${s.id}`,children:"Delete"})]})]},n))})]}),d.length>5&&e.jsx(Z,{totalPages:g,page:a,limit:o,siblings:1,onPageChange:L}),P&&e.jsx("span",{className:"red",children:"Có lỗi khi tải"})]})}),e.jsx(u,{to:"/admin/book/new",className:"create-category-btn",children:e.jsx(T,{})})]})]})};export{te as default};
