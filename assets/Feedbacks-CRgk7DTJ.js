import{c as T,r as t,a as d,A as h,l as p,j as e,x as B,y as E,z as I,K as z,T as L,_ as o}from"./index-BSbp0FSU.js";import{A as R,a as q}from"./AdminSidebarMobile-4DVHEuT3.js";import{a as M}from"./index-DQBNxnBM.js";import{P as U}from"./Pagination-Cu-JZCf2.js";const K=()=>{const{token:c}=T(s=>s.user),[x,j]=t.useState(!1),[A,g]=t.useState(!1),[m,k]=t.useState(!1),[b,N]=t.useState([]),[y,w]=t.useState(null),[i,n]=t.useState(1),[l]=t.useState(5),[u,S]=t.useState(0);t.useEffect(()=>{f(),console.log(c)},[]);const f=async()=>{g(!0),await d.get(h+p,{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${c}`}}).then(s=>s.data).then(s=>{N(s),S(Math.ceil(s.length/l))}).catch(s=>{w("List of Feedbacks unavailable"),console.log(s)}).finally(()=>{g(!1)})},C=async s=>{await d({url:`${h}${p}/DownloadFile/${s}`,method:"GET",responseType:"blob",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${c}`}}).then(a=>{const P=a.data.type.split("/")[1],v=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=v,console.log(v),r.setAttribute("download",`${L()}-downloadedFile.${P}`),document.body.appendChild(r),r.click(),o.success("Download file successfully")}).catch(a=>{console.log(a),o.error("Download file failed")})};function $(s){s==="&laquo;"||s==="... "?n(1):s==="&lsaquo;"?i!==1&&n(i-1):s==="&rsaquo;"?i!==u&&n(i+1):s==="&raquo;"||s===" ..."?n(u):typeof s=="number"&&n(s)}const D=s=>{d.delete(`${h}${p}/${s}`,{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${c}`}}).then(a=>{a.status===204&&(o.success("Delete this feedback successfully."),f())}).catch(a=>{console.log(a.message),o.error("Delete this feedback unsuccessfully.")})},F=s=>{d.put(`${h}${p}/${s}`,{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${c}`}}).then(a=>{a.status===204&&f()}).catch(a=>{console.log(a.message),o.error("Delete this feedback unsuccessfully.")})};return e.jsxs("div",{className:"admin-container",style:{gridTemplateColumns:m?"1fr 15fr":"1fr 4fr",gap:m?"0.5rem":"2rem"},children:[e.jsx(R,{isFold:m,setIsFold:k}),e.jsx(q,{isOpen:x,setIsOpen:j}),e.jsx("div",{className:"open-menu-icon",children:e.jsx(B,{size:24,onClick:()=>j(!x)})}),e.jsxs("main",{className:"dashboard",children:[e.jsxs("div",{className:"bar",children:[e.jsx(E,{}),e.jsx("input",{type:"text",placeholder:"Search for data, users, docs"}),e.jsx(I,{}),e.jsx("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSXPodEp1Zyixlyx1Rrq6JJlPm0hgg1pFeLNrxgt2bkYw&s",alt:"User"})]}),e.jsx("div",{className:"table-container",children:e.jsxs("div",{className:"dashboard-category-box",children:[e.jsx("h2",{className:"heading",children:"Feedback"}),A&&e.jsx("span",{children:"Loading..."}),b&&e.jsx("div",{className:"feedback-item-list",children:b.slice((i-1)*l,(i-1)*l+l).map((s,a)=>e.jsxs("div",{className:"feedback-item-container",children:[e.jsxs("div",{className:"feedback-item",children:[e.jsxs("div",{className:"user-wrapper",children:[e.jsx("img",{src:s.avatar,alt:s.username}),e.jsxs("div",{className:"user-wrapper",children:[e.jsx("h4",{children:s.username}),e.jsx("div",{children:s.createdAt})]})]}),e.jsxs("div",{className:"feedback-content",children:[e.jsx("h3",{children:s.title}),e.jsx("div",{children:s.content}),s.isActive?e.jsx("h4",{style:{color:"blue"},children:"Active"}):e.jsx("h4",{children:"Proccessing"})]})]}),e.jsxs("div",{className:"action-wrapper",children:[e.jsx("div",{className:"btn-feedback btn-active",style:{opacity:s.isActive?"0.6":"1",cursor:s.isActive?"default":"pointer"},onClick:()=>{s.isActive||F(s.id)},children:"Process Status"}),e.jsxs("div",{className:"active-feedback",children:[e.jsx("div",{className:"blue",style:{display:"flex",alignItems:"center",marginRight:"0.2rem"},children:e.jsx(z,{onClick:()=>C(s.id),size:20})}),"Download"]}),e.jsxs("div",{className:"active-feedback",children:[e.jsx("div",{className:"red",style:{display:"flex",alignItems:"center",marginRight:"0.2rem"},children:e.jsx(M,{onClick:()=>D(s.id),size:20})}),"Delete Feedback"]})]})]},a))}),y&&e.jsx("div",{className:"red",children:y}),e.jsx(U,{totalPages:u,page:i,limit:l,siblings:1,onPageChange:$})]})})]})]})};export{K as default};
