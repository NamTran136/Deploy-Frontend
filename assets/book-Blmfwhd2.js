import{c as te,r as k,a as C,A as S,p as Z,j as r,_ as W,q as ne,n as ue,B as M,t as R,L as X,I as Y,W as he}from"./index-BSbp0FSU.js";import{T as ie}from"./Title-DvW9DyvO.js";import{S as we,M as fe}from"./Menu-Y_NbBSX3.js";import{A as me}from"./index-CrNBYFTV.js";import{I as ge}from"./index-DQBNxnBM.js";import"./index-DRhXAqaf.js";const pe=({bookId:e,email:t})=>{const{token:n}=te(f=>f.user),[o,a]=k.useState(),[l,i]=k.useState(!1),[d,w]=k.useState(null);k.useEffect(()=>{s()},[]);const s=()=>{i(!0),C.get(S+Z+"/book="+e).then(f=>{a(f.data),w(null)}).catch(f=>{w("Có lỗi xảy ra khi tải."),console.log(f)}).finally(()=>{i(!1)})},[c,u]=k.useState(""),g=async f=>{if(f.preventDefault(),console.log({content:c,email:t,bookId:e}),!t){W.error("Bạn cần đăng nhập trước khi bình luận.");return}await C.post(`${S}${Z}`,{content:c,email:t,bookId:e},{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${n}`}}).then(p=>{p.status===200&&(u(""),s(),console.log(1))}).catch(p=>{console.log(p.message),W.error("Có lỗi xảy ra!")})};return r.jsxs("div",{className:"comment",children:[r.jsx(ie,{text:"Bình luận"}),r.jsxs("div",{children:[r.jsxs("div",{className:"comment-list",children:[l&&r.jsx("div",{children:"Loading..."}),o&&(o==null?void 0:o.map((f,p)=>r.jsx("div",{className:"comment-list-item",children:r.jsxs("div",{className:"user-comment",children:[r.jsx("div",{className:"user-comment-img",children:r.jsx("img",{src:`${f==null?void 0:f.imageUrl}`,alt:""})}),r.jsxs("div",{className:"content-wrapper",children:[r.jsx("h4",{children:f.username}),f.content,r.jsx("div",{className:"time-comment",children:r.jsx("span",{children:f==null?void 0:f.timeUp})})]})]})},p))),d&&r.jsx("div",{className:"red book-message",children:r.jsx("span",{children:""+d})})]}),r.jsx("form",{onSubmit:g,children:r.jsxs("div",{className:"comment-form",children:[r.jsxs("div",{className:"comment-form-input",children:[r.jsx("label",{htmlFor:"comment",children:"Bình luận của bạn"}),r.jsx("textarea",{id:"comment",rows:2,className:"",placeholder:"Write a comment...",required:!0,onChange:f=>u(f.target.value),value:c})]}),r.jsx("div",{className:"btn-submit",children:r.jsx("button",{type:"submit",className:"inline-flex items-center py-2.5 px-4 text-xs font-medium text-center text-white bg-blue-700 rounded-lg focus:ring-4 focus:ring-blue-200 hover:bg-blue-800",children:"Post comment"})})]})})]})]})};var re={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var l="",i=0;i<arguments.length;i++){var d=arguments[i];d&&(l=a(l,o(d)))}return l}function o(l){if(typeof l=="string"||typeof l=="number")return l;if(typeof l!="object")return"";if(Array.isArray(l))return n.apply(null,l);if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]"))return l.toString();var i="";for(var d in l)t.call(l,d)&&l[d]&&(i=a(i,d));return i}function a(l,i){return i?l?l+" "+i:l+i:l}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(re);var ve=re.exports;const oe=ne(ve);var U={exports:{}},F={exports:{}},$=1e3,A=$*60,B=A*60,P=B*24,be=P*365.25,ke=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return ye(e);if(n==="number"&&isNaN(e)===!1)return t.long?xe(e):je(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function ye(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),o=(t[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"yrs":case"yr":case"y":return n*be;case"days":case"day":case"d":return n*P;case"hours":case"hour":case"hrs":case"hr":case"h":return n*B;case"minutes":case"minute":case"mins":case"min":case"m":return n*A;case"seconds":case"second":case"secs":case"sec":case"s":return n*$;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function je(e){return e>=P?Math.round(e/P)+"d":e>=B?Math.round(e/B)+"h":e>=A?Math.round(e/A)+"m":e>=$?Math.round(e/$)+"s":e+"ms"}function xe(e){return H(e,P,"day")||H(e,B,"hour")||H(e,A,"minute")||H(e,$,"second")||e+" ms"}function H(e,t,n){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}(function(e,t){t=e.exports=a.debug=a.default=a,t.coerce=w,t.disable=i,t.enable=l,t.enabled=d,t.humanize=ke,t.names=[],t.skips=[],t.formatters={};var n;function o(s){var c=0,u;for(u in s)c=(c<<5)-c+s.charCodeAt(u),c|=0;return t.colors[Math.abs(c)%t.colors.length]}function a(s){function c(){if(c.enabled){var u=c,g=+new Date,f=g-(n||g);u.diff=f,u.prev=n,u.curr=g,n=g;for(var p=new Array(arguments.length),N=0;N<p.length;N++)p[N]=arguments[N];p[0]=t.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");var x=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,function(h,_){if(h==="%%")return h;x++;var j=t.formatters[_];if(typeof j=="function"){var K=p[x];h=j.call(u,K),p.splice(x,1),x--}return h}),t.formatArgs.call(u,p);var L=c.log||t.log||console.log.bind(console);L.apply(u,p)}}return c.namespace=s,c.enabled=t.enabled(s),c.useColors=t.useColors(),c.color=o(s),typeof t.init=="function"&&t.init(c),c}function l(s){t.save(s),t.names=[],t.skips=[];for(var c=(typeof s=="string"?s:"").split(/[\s,]+/),u=c.length,g=0;g<u;g++)c[g]&&(s=c[g].replace(/\*/g,".*?"),s[0]==="-"?t.skips.push(new RegExp("^"+s.substr(1)+"$")):t.names.push(new RegExp("^"+s+"$")))}function i(){t.enable("")}function d(s){var c,u;for(c=0,u=t.skips.length;c<u;c++)if(t.skips[c].test(s))return!1;for(c=0,u=t.names.length;c<u;c++)if(t.names[c].test(s))return!0;return!1}function w(s){return s instanceof Error?s.stack||s.message:s}})(F,F.exports);var Ce=F.exports;(function(e,t){var n={};t=e.exports=Ce,t.log=l,t.formatArgs=a,t.save=i,t.load=d,t.useColors=o,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:w(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function o(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(s){try{return JSON.stringify(s)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}};function a(s){var c=this.useColors;if(s[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+s[0]+(c?"%c ":" ")+"+"+t.humanize(this.diff),!!c){var u="color: "+this.color;s.splice(1,0,u,"color: inherit");var g=0,f=0;s[0].replace(/%[a-zA-Z%]/g,function(p){p!=="%%"&&(g++,p==="%c"&&(f=g))}),s.splice(f,0,u)}}function l(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(s){try{s==null?t.storage.removeItem("debug"):t.storage.debug=s}catch{}}function d(){var s;try{s=t.storage.debug}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=n.DEBUG),s}t.enable(d());function w(){try{return window.localStorage}catch{}}})(U,U.exports);var Se=U.exports,Q=Se("jsonp"),Ne=Oe,_e=0;function Ie(){}function Oe(e,t,n){typeof t=="function"&&(n=t,t={}),t||(t={});var o=t.prefix||"__jp",a=t.name||o+_e++,l=t.param||"callback",i=t.timeout!=null?t.timeout:6e4,d=encodeURIComponent,w=document.getElementsByTagName("script")[0]||document.head,s,c;i&&(c=setTimeout(function(){u(),n&&n(new Error("Timeout"))},i));function u(){s.parentNode&&s.parentNode.removeChild(s),window[a]=Ie,c&&clearTimeout(c)}function g(){window[a]&&u()}return window[a]=function(f){Q("jsonp got",f),u(),n&&n(null,f)},e+=(~e.indexOf("?")?"&":"?")+l+"="+d(a),e=e.replace("?&","?"),Q('jsonp req "%s"',e),s=document.createElement("script"),s.src=e,w.parentNode.insertBefore(s,w),g}const I=ne(Ne);var Le=Object.defineProperty,$e=Object.defineProperties,Ae=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,ee=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))ae.call(t,n)&&ee(e,n,t[n]);if(V)for(var n of V(t))se.call(t,n)&&ee(e,n,t[n]);return e},T=(e,t)=>$e(e,Ae(t)),z=(e,t)=>{var n={};for(var o in e)ae.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&V)for(var o of V(e))t.indexOf(o)<0&&se.call(e,o)&&(n[o]=e[o]);return n};function q(e){return n=>{var o=n,{bgStyle:a={},borderRadius:l=0,iconFillColor:i="white",round:d=!1,size:w=64}=o,s=z(o,["bgStyle","borderRadius","iconFillColor","round","size"]);return r.jsxs("svg",T(y({viewBox:"0 0 64 64",width:w,height:w},s),{children:[d?r.jsx("circle",{cx:"32",cy:"32",r:"32",fill:e.color,style:a}):r.jsx("rect",{width:"64",height:"64",rx:l,ry:l,fill:e.color,style:a}),r.jsx("path",{d:e.path,fill:i})]}))}}function m(e){const t=Object.entries(e).filter(([,n])=>n!=null).map(([n,o])=>`${encodeURIComponent(n)}=${encodeURIComponent(String(o))}`);return t.length>0?`?${t.join("&")}`:""}const Be=e=>!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function",Pe=(e,t)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-e/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-t/2}),Ee=(e,t)=>({top:(window.screen.height-t)/2,left:(window.screen.width-e)/2});function He(e,t,n){var o=t,{height:a,width:l}=o,i=z(o,["height","width"]);const d=y({height:a,width:l,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},i),w=window.open(e,"",Object.keys(d).map(s=>`${s}=${d[s]}`).join(", "));if(n){const s=window.setInterval(()=>{try{(w===null||w.closed)&&(window.clearInterval(s),n(w))}catch(c){console.error(c)}},1e3)}return w}function We(e){var t=e,{beforeOnClick:n,children:o,className:a,disabled:l,disabledStyle:i={opacity:.6},forwardedRef:d,htmlTitle:w,networkLink:s,networkName:c,onClick:u,onShareWindowClose:g,openShareDialogOnClick:f=!0,opts:p,resetButtonStyle:N=!0,style:x,url:L,windowHeight:h=400,windowPosition:_="windowCenter",windowWidth:j=550}=t,K=z(t,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","url","windowHeight","windowPosition","windowWidth"]);const ce=async J=>{const G=s(L,p);if(!l){if(J.preventDefault(),n){const E=n();Be(E)&&await E}if(f){const E=y({height:h,width:j},_==="windowCenter"?Pe(j,h):Ee(j,h));He(G,E,g)}u&&u(J,G)}},le=oe("react-share__ShareButton",{"react-share__ShareButton--disabled":!!l,disabled:!!l},a),de=y(y(N?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},x),l&&i);return r.jsx("button",T(y({},K),{className:le,onClick:ce,ref:d,style:de,title:w,children:o}))}function b(e,t,n,o){function a(l,i){const d=n(l),w=y({},l);return Object.keys(d).forEach(c=>{delete w[c]}),r.jsx(We,T(y(y({},o),w),{forwardedRef:i,networkName:e,networkLink:t,opts:n(l)}))}return a.displayName=`ShareButton-${e}`,k.forwardRef(a)}function Ve(e,{subject:t,body:n,separator:o}){return"mailto:"+m({subject:t,body:n?n+o+e:e})}b("email",Ve,e=>({subject:e.subject,body:e.body,separator:e.separator||" "}),{openShareDialogOnClick:!1,onClick:(e,t)=>{window.location.href=t}});const Te=q({color:"#0965FE",networkName:"facebook",path:"M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z"}),ze=Te;function Ke(e,{appId:t,redirectUri:n,to:o}){return"https://www.facebook.com/dialog/send"+m({link:e,redirect_uri:n||e,app_id:t,to:o})}b("facebookmessenger",Ke,e=>({appId:e.appId,redirectUri:e.redirectUri,to:e.to}),{windowWidth:1e3,windowHeight:820});class Me extends Error{constructor(t){super(t),this.name="AssertionError"}}function v(e,t){if(!e)throw new Me(t)}function Re(e,{hashtag:t}){return v(e,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+m({u:e,hashtag:t})}const De=b("facebook",Re,e=>({hashtag:e.hashtag}),{windowWidth:550,windowHeight:400}),Ue=De;function Fe(){const e=k.useRef(!1);return k.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),k.useCallback(()=>e.current,[])}function qe(e){var t=e,{children:n=g=>g,className:o,getCount:a,url:l}=t,i=z(t,["children","className","getCount","url"]);const d=Fe(),[w,s]=k.useState(void 0),[c,u]=k.useState(!1);return k.useEffect(()=>{u(!0),a(l,g=>{d()&&(s(g),u(!1))})},[l]),r.jsx("span",T(y({className:oe("react-share__ShareCount",o)},i),{children:!c&&w!==void 0&&n(w)}))}function O(e){const t=n=>r.jsx(qe,y({getCount:e},n));return t.displayName=`ShareCount(${e.name})`,t}function Je(e,t){const n=`https://graph.facebook.com/?id=${e}&fields=og_object{engagement}`;I(n,(o,a)=>{t(!o&&a&&a.og_object&&a.og_object.engagement?a.og_object.engagement.count:void 0)})}O(Je);function Ge(e,{title:t}){return v(e,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${e}&title=${t}`}b("hatena",Ge,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function Ze(e,t){I("https://bookmark.hatenaapis.com/count/entry"+m({url:e}),(o,a)=>{t(a??void 0)})}O(Ze);function Xe(e,{title:t,description:n}){return v(e,"instapaper.url"),"http://www.instapaper.com/hello2"+m({url:e,title:t,description:n})}b("instapaper",Xe,e=>({title:e.title,description:e.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});function Ye(e,{title:t}){return v(e,"line.url"),"https://social-plugins.line.me/lineit/share"+m({url:e,text:t})}b("line",Ye,e=>({title:e.title}),{windowWidth:500,windowHeight:500});const Qe=q({color:"#0077B5",networkName:"linkedin",path:"M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z"}),et=Qe;function tt(e,{title:t,summary:n,source:o}){return v(e,"linkedin.url"),"https://linkedin.com/shareArticle"+m({url:e,mini:"true",title:t,summary:n,source:o})}const nt=b("linkedin",tt,({title:e,summary:t,source:n})=>({title:e,summary:t,source:n}),{windowWidth:750,windowHeight:600}),it=nt;function rt(e,{title:t,description:n}){return v(e,"livejournal.url"),"https://www.livejournal.com/update.bml"+m({subject:t,event:n})}b("livejournal",rt,e=>({title:e.title,description:e.description}),{windowWidth:660,windowHeight:460});function ot(e,{title:t,description:n,imageUrl:o}){return v(e,"mailru.url"),"https://connect.mail.ru/share"+m({url:e,title:t,description:n,image_url:o})}b("mailru",ot,e=>({title:e.title,description:e.description,imageUrl:e.imageUrl}),{windowWidth:660,windowHeight:460});function at(e,{title:t,description:n,image:o}){return v(e,"ok.url"),"https://connect.ok.ru/offer"+m({url:e,title:t,description:n,imageUrl:o})}b("ok",at,e=>({title:e.title,description:e.description,image:e.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function st(e,t){window.OK||(window.OK={Share:{count:function(l,i){var d,w;(w=(d=window.OK.callbacks)[l])==null||w.call(d,i)}},callbacks:[]});const n="https://connect.ok.ru/dk",o=window.OK.callbacks.length;return window.ODKL={updateCount(a,l){var i,d;const w=a===""?0:parseInt(a.replace("react-share-",""),10);(d=(i=window.OK.callbacks)[w])==null||d.call(i,l===""?void 0:parseInt(l,10))}},window.OK.callbacks.push(t),I(n+m({"st.cmd":"extLike",uid:`react-share-${o}`,ref:e}))}O(st);function ct(e,{media:t,description:n,pinId:o}){return o?`https://pinterest.com/pin/${o}/repin/x/`:(v(e,"pinterest.url"),v(t,"pinterest.media"),"https://pinterest.com/pin/create/button/"+m({url:e,media:t,description:n}))}b("pinterest",ct,e=>({media:e.media,description:e.description,pinId:e.pinId}),{windowWidth:1e3,windowHeight:730});function lt(e,t){I("https://api.pinterest.com/v1/urls/count.json"+m({url:e}),(o,a)=>{t(a?a.count:void 0)})}O(lt);function dt(e,{title:t}){return v(e,"pocket.url"),"https://getpocket.com/save"+m({url:e,title:t})}b("pocket",dt,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function ut(e,{title:t}){return v(e,"reddit.url"),"https://www.reddit.com/submit"+m({url:e,title:t})}b("reddit",ut,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function ht(e,{title:t}){return v(e,"gab.url"),"https://gab.com/compose"+m({url:e,text:t})}b("gab",ht,e=>({title:e.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function wt(e,t){const n=`https://www.reddit.com/api/info.json?limit=1&url=${e}`;I(n,{param:"jsonp"},(o,a)=>{t(!o&&a&&a.data&&a.data.children.length>0&&a.data.children[0].data.score?a.data.children[0].data.score:void 0)})}O(wt);function ft(e,{title:t}){return v(e,"telegram.url"),"https://telegram.me/share/url"+m({url:e,text:t})}b("telegram",ft,e=>({title:e.title}),{windowWidth:550,windowHeight:400});function mt(e,{title:t,caption:n,tags:o,posttype:a}){return v(e,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+m({canonicalUrl:e,title:t,caption:n,tags:o,posttype:a})}b("tumblr",mt,e=>({title:e.title,tags:(e.tags||[]).join(","),caption:e.caption,posttype:e.posttype||"link"}),{windowWidth:660,windowHeight:460});function gt(e,t){return I("https://api.tumblr.com/v2/share/stats"+m({url:e}),(o,a)=>{t(!o&&a&&a.response?a.response.note_count:void 0)})}O(gt);const pt=q({color:"#00aced",networkName:"twitter",path:"M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"}),vt=pt;function bt(e,{title:t,via:n,hashtags:o=[],related:a=[]}){return v(e,"twitter.url"),v(Array.isArray(o),"twitter.hashtags is not an array"),v(Array.isArray(a),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+m({url:e,text:t,via:n,hashtags:o.length>0?o.join(","):void 0,related:a.length>0?a.join(","):void 0})}const kt=b("twitter",bt,e=>({hashtags:e.hashtags,title:e.title,via:e.via,related:e.related}),{windowWidth:550,windowHeight:400}),yt=kt;function jt(e,{title:t,separator:n}){return v(e,"viber.url"),"viber://forward"+m({text:t?t+n+e:e})}b("viber",jt,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460});function xt(e,{title:t,image:n,noParse:o,noVkLinks:a}){return v(e,"vk.url"),"https://vk.com/share.php"+m({url:e,title:t,image:n,noparse:o?1:0,no_vk_links:a?1:0})}b("vk",xt,e=>({title:e.title,image:e.image,noParse:e.noParse,noVkLinks:e.noVkLinks}),{windowWidth:660,windowHeight:460});function Ct(e,t){window.VK||(window.VK={}),window.VK.Share={count:(a,l)=>{var i,d;return(d=(i=window.VK.callbacks)==null?void 0:i[a])==null?void 0:d.call(i,l)}},window.VK.callbacks=[];const n="https://vk.com/share.php",o=window.VK.callbacks.length;return window.VK.callbacks.push(t),I(n+m({act:"count",index:o,url:e}))}O(Ct);function St(e,{title:t,image:n}){return v(e,"weibo.url"),"http://service.weibo.com/share/share.php"+m({url:e,title:t,pic:n})}b("weibo",St,e=>({title:e.title,image:e.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});function Nt(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function _t(e,{title:t,separator:n}){return v(e,"whatsapp.url"),"https://"+(Nt()?"api":"web")+".whatsapp.com/send"+m({text:t?t+n+e:e})}b("whatsapp",_t,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:550,windowHeight:400});function It(e,{quote:t,hashtag:n}){return v(e,"workplace.url"),"https://work.facebook.com/sharer.php"+m({u:e,quote:t,hashtag:n})}b("workplace",It,e=>({quote:e.quote,hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});const D=window.location.href,Ot="Share book",Ht=()=>{const{user:e,token:t}=te(h=>h.user),[n,o]=k.useState(!1),[a,l]=k.useState(!1),[i,d]=k.useState(),[w,s]=k.useState(null),{bookId:c}=ue();let u=0;c===void 0?u=0:u=parseInt(c),k.useEffect(()=>{g(),f(u,e.email),localStorage.setItem("previousUrl",window.location.href)},[t]);const g=async()=>{o(!0),await C.get(S+M+"/"+c).then(h=>{const _=h.data;d(_),s(null)}).catch(h=>{s("Không có sách nào có ID = "+c),console.log(h)}).finally(()=>{o(!1)})},f=async(h,_)=>{await C.get(S+R+`/bookId=${h}/email=${_}`).then(j=>{l(j.data)}).catch(j=>{console.log(j)})},p=async()=>{if(e.email===""){W.error("Vui lòng đăng nhập trước khi dùng tính năng yêu thích");return}a?await C.delete(S+R+`/bookId=${c}/email=${e.email}`,{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`}}).then(h=>{console.log(h.status)}).catch(h=>{console.log(h)}):await C.post(S+R,{email:e.email,bookId:parseInt(c||"0")},{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`}}).then(h=>{console.log(h.status)}).catch(h=>{console.log(h)}),l(!a)},N=async()=>{await C.put(S+M+"/downloadingbook",{email:e.email,bookId:parseInt(c||"0")},{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`}}).then(h=>{console.log(h.status),g()}).catch(h=>{console.log(h)})},x=async()=>{await C.put(S+M+`/readingbook=${c}`).then(h=>{console.log(h.status)}).catch(h=>{console.log(h)})},L=async()=>{await C.post(S+he,{email:e.email,bookId:parseInt(c||"0")},{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`}}).then(h=>{console.log(h.status)}).catch(h=>{console.log(h.message)})};return r.jsxs("div",{className:"allBook-container",children:[r.jsxs("div",{className:"allBook-content",children:[n&&r.jsx("span",{children:"Loading..."}),w&&r.jsx("span",{className:"red",children:"Có lỗi xảy ra trong quá trình tải"}),i&&r.jsxs("div",{className:"book-wrapper",children:[r.jsx(ie,{text:`${i.category} > ${i.title}`}),r.jsxs("div",{className:"book-image-wrapper",children:[r.jsxs("div",{className:"book-image",children:[r.jsx("img",{src:i==null?void 0:i.imageUrl,alt:i==null?void 0:i.title,className:"mx-auto w-max-width h-auto"}),localStorage.getItem("token")===null&&(i==null?void 0:i.isPrivate)&&r.jsx("div",{className:"book-image-subitem",children:"Cần đăng nhập"})]}),r.jsxs("div",{className:"book-detail",children:[r.jsx("div",{className:"book-title",children:i==null?void 0:i.title}),r.jsxs("div",{className:"mt-2",children:["Tác giả: ",i==null?void 0:i.author]}),r.jsxs("div",{className:"mt-2",children:["Thể loại:"," ",r.jsx(X,{to:`/Books/category/${i==null?void 0:i.categoryId}`,className:"book-title-link",children:i==null?void 0:i.category})]}),r.jsxs("div",{className:"mt-2",children:["Ngôn ngữ: ",i==null?void 0:i.language]}),r.jsxs("div",{className:"mt-2",style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",marginRight:"2rem"},children:[r.jsx(me,{})," ",i==null?void 0:i.numOfDownloads]}),r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(ge,{})," ",i==null?void 0:i.numOfViews]})]}),localStorage.getItem("token")===null&&(i==null?void 0:i.isPrivate)&&r.jsx("div",{className:"red book-message",children:"Vui lòng đăng nhập trước khi tải hoặc đọc ebook"}),(localStorage.getItem("token")!==null&&(i==null?void 0:i.isPrivate)||!(i!=null&&i.isPrivate))&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"green book-message",children:"Vui lòng chọn tải file hoặc đọc online"}),r.jsxs("div",{className:"book-btn-wrapper",children:[r.jsx("button",{type:"button",className:"bg-red text-white",onClick:()=>{e.email?(N(),window.location.href=`https://drive.google.com/uc?export=download&id=${i==null?void 0:i.code}`):W.error("Vui lòng đăng nhập trước khi tải sách")},children:"Tải PDF"}),r.jsx("button",{type:"button",className:"bg-blue",onClick:()=>{x(),t&&(console.log(123),L())},children:r.jsx(X,{className:"text-white",to:`/reading-book/${i==null?void 0:i.id}`,style:{display:"block",width:"100%",height:"100%",lineHeight:"32px"},children:"Đọc sách"})})]})]}),r.jsxs("div",{className:"mt-2 social-media-share",children:[r.jsx("div",{className:"like-icon",onClick:p,children:a?r.jsx(Y,{size:32,style:{borderRadius:"50%",color:"red"}}):r.jsx(Y,{size:32,style:{borderRadius:"50%",color:"#000"}})}),r.jsxs("div",{className:"social-media-wrapper",children:[r.jsx("div",{children:r.jsx(Ue,{url:D,children:r.jsx(ze,{size:32,round:!0})})}),r.jsx("div",{children:r.jsx(yt,{url:D,title:Ot,children:r.jsx(vt,{size:32,round:!0})})}),r.jsx("div",{children:r.jsx(it,{url:D,children:r.jsx(et,{size:32,round:!0})})})]})]})]})]}),r.jsx("div",{className:"separate",children:""}),r.jsxs("div",{className:"book-description-wrapper",children:[r.jsx("div",{className:"book-description-title",children:i==null?void 0:i.title}),r.jsx("p",{children:i==null?void 0:i.description})]})]})]}),r.jsx("div",{className:"sub-item-container",children:r.jsx(we,{})}),r.jsx("div",{className:"menu-container",children:r.jsx(fe,{})}),r.jsx(pe,{bookId:u,email:(e==null?void 0:e.email)||""})]})};export{Ht as default};
